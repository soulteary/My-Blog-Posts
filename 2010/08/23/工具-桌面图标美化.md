# [工具]桌面图标美化

我还是偷懒了，很早以前的一个东西，本来都扔掉的，今天看到一个MSDN上的BUG，突然想起来了，就重新写了一下。

事情是这个样子的。

[![使用预览](https://attachment.soulteary.com/2010/08/23/2010-08-23_212751.gif "使用预览")](https://attachment.soulteary.com/2010/08/23/2010-08-23_212751.gif)

[![界面预览](https://attachment.soulteary.com/2010/08/23/2010-08-23_220205.gif "界面预览")](https://attachment.soulteary.com/2010/08/23/2010-08-23_220205.gif)

如果你在VB中使用资源编辑器放入了一个图标，当你使用LoadResData读取的时候会发生一点小错误。

> 错误: 运行时错误"326"，LoadResData
> 运行时错误"326": 找不到标识符"101"具有的资源

这个东西果然很诡异，详见微软MSDN,[http://support.microsoft.com/kb/190477/zh-cn](http://support.microsoft.com/kb/190477/zh-cn)

> Microsoft 已经确认这是在本文开头列出的 Microsoft 产品中的错误。我们将研究此 bug 并将发布新的信息 Microsoft 知识库中相应可用。

看着微软的状态信息，再搜索了一下网上，果然木有人把解决方法写出来，于是，我就小小的抛砖引玉了。

首先他不是说是图标资源会出现这个问题么，叫我们使用LoadResPicture，但是使用LoadResPicture的时候，我们就不能再从资源文件内释放出我们所需要的图标文件了，经过测试，简单的修改文件的前20字节，或者修改后缀都是不可行的。

正当准备放弃的时候，想起以前写的一个小小的恶作剧程序，既然修改一点不行，那么就修改的它老妈都不认识它~

于是在程序中加入了整体异或，你使用其他的加密方式或者处理方法也可以，但是必须做到上面说的修改幅度~

最后在释放资源的时候再进行解码操作即可。

这个小工具只是为了存档，所以上传，可能唯一的用处就是新装系统后，用于释放文件，美化桌面图标了，有时间继续完善一下吧。

> 支持命令行 -chs 和 -enu

[![HASH](https://attachment.soulteary.com/2010/08/23/2010-08-23_220303.gif "HASH")](https://attachment.soulteary.com/2010/08/23/2010-08-23_220303.gif)

